#include <iostream>
#include "general_regression.h"
#include <cmath>


int main()
{

    Func* basis = AbsErfBasis::GenerateBasis();
    double data_outputs[134];
    int* X[134];
    
    X[0] = new int[8]{3, 3, 4, 1, 1, 2, 2, 5};
    X[1] = new int[8]{4, 4, 5, 2, 2, 3, 3, 6};

    X[2] = new int[8]{4, 3, 3, 4, 3, 3, 5, 4};
    X[3] = new int[8]{5, 4, 4, 5, 4, 4, 6, 5};

    X[4] = new int[8]{5, 4, 2, 2, 2, 5, 1, 4};
    X[5] = new int[8]{6, 5, 3, 3, 3, 6, 2, 5};

    X[6] = new int[8]{5, 5, 3, 3, 2, 2, 3, 5};
    X[7] = new int[8]{6, 6, 4, 4, 3, 3, 4, 6};

    X[8] = new int[8]{4, 3, 4, 3, 3, 3, 5, 4};
    X[9] = new int[8]{5, 4, 5, 4, 4, 4, 6, 5};

    X[10] = new int[8]{3, 3, 5, 4, 3, 1, 4, 4};
    X[11] = new int[8]{4, 4, 6, 5, 4, 2, 5, 5};

    X[12] = new int[8]{4, 1, 4, 1, 1, 4, 5, 5};
    X[13] = new int[8]{5, 2, 5, 2, 2, 5, 6, 6};

    X[14] = new int[8]{5, 1, 5, 2, 4, 1, 2, 1};
    X[15] = new int[8]{6, 2, 6, 3, 5, 2, 3, 2};

    X[16] = new int[8]{4, 3, 2, 1, 2, 5, 4, 5};
    X[17] = new int[8]{5, 4, 3, 2, 3, 6, 5, 6};

    X[18] = new int[8]{2, 1, 2, 3, 1, 3, 1, 1};
    X[19] = new int[8]{3, 2, 3, 4, 2, 4, 2, 2};

    X[20] = new int[8]{4, 3, 4, 3, 5, 5, 2, 1};
    X[21] = new int[8]{5, 4, 5, 4, 6, 6, 3, 2};

    X[22] = new int[8]{3, 2, 2, 3, 3, 2, 1, 4};
    X[23] = new int[8]{4, 3, 3, 4, 4, 3, 2, 5};

    X[24] = new int[8]{5, 1, 5, 3, 4, 3, 1, 3};
    X[25] = new int[8]{6, 2, 6, 4, 5, 4, 2, 4};

    X[26] = new int[8]{5, 2, 1, 5, 1, 4, 3, 1};
    X[27] = new int[8]{6, 3, 2, 6, 2, 5, 4, 2};

    X[28] = new int[8]{3, 2, 5, 2, 1, 5, 4, 1};
    X[29] = new int[8]{4, 3, 6, 3, 2, 6, 5, 2};

    X[30] = new int[8]{3, 4, 5, 2, 3, 3, 5, 2};
    X[31] = new int[8]{4, 5, 6, 3, 4, 4, 6, 3};

    X[32] = new int[8]{3, 1, 2, 1, 4, 1, 5, 1};
    X[33] = new int[8]{4, 2, 3, 2, 5, 2, 6, 2};

    X[34] = new int[8]{5, 3, 3, 4, 1, 5, 2, 3};
    X[35] = new int[8]{6, 4, 4, 5, 2, 6, 3, 4};

    X[36] = new int[8]{4, 4, 3, 4, 5, 3, 5, 1};
    X[37] = new int[8]{5, 5, 4, 5, 6, 4, 6, 2};

    X[38] = new int[8]{4, 1, 3, 3, 1, 4, 2, 5};
    X[39] = new int[8]{5, 2, 4, 4, 2, 5, 3, 6};

    X[40] = new int[8]{4, 2, 3, 3, 4, 3, 2, 5};
    X[41] = new int[8]{5, 3, 4, 4, 5, 4, 3, 6};

    X[42] = new int[8]{3, 2, 3, 1, 3, 2, 4, 4};
    X[43] = new int[8]{4, 3, 4, 2, 4, 3, 5, 5};

    X[44] = new int[8]{4, 3, 4, 5, 4, 2, 2, 3};
    X[45] = new int[8]{5, 4, 5, 6, 5, 3, 3, 4};

    X[46] = new int[8]{2, 5, 3, 5, 5, 3, 1, 3};
    X[47] = new int[8]{3, 6, 4, 6, 6, 4, 2, 4};

    X[48] = new int[8]{2, 3, 2, 2, 5, 3, 5, 1};
    X[49] = new int[8]{3, 4, 3, 3, 6, 4, 6, 2};

    X[50] = new int[8]{3, 5, 5, 4, 5, 1, 1, 3};
    X[51] = new int[8]{4, 6, 6, 5, 6, 2, 2, 4};

    X[52] = new int[8]{2, 4, 4, 1, 1, 4, 3, 5};
    X[53] = new int[8]{3, 5, 5, 2, 2, 5, 4, 6};

    X[54] = new int[8]{2, 2, 3, 4, 5, 4, 5, 3};
    X[55] = new int[8]{3, 3, 4, 5, 6, 5, 6, 4};

    X[56] = new int[8]{5, 1, 3, 5, 3, 4, 3, 1};
    X[57] = new int[8]{6, 2, 4, 6, 4, 5, 4, 2};

    X[58] = new int[8]{3, 1, 3, 5, 1, 1, 3, 5};
    X[59] = new int[8]{4, 2, 4, 6, 2, 2, 4, 6};

    X[60] = new int[8]{2, 2, 3, 3, 5, 5, 1, 5};
    X[61] = new int[8]{3, 3, 4, 4, 6, 6, 2, 6};

    X[62] = new int[8]{3, 3, 3, 1, 5, 5, 4, 3};
    X[63] = new int[8]{4, 4, 4, 2, 6, 6, 5, 4};

    X[64] = new int[8]{4, 1, 2, 4, 1, 1, 3, 2};
    X[65] = new int[8]{5, 2, 3, 5, 2, 2, 4, 3};

    X[66] = new int[8]{2, 5, 2, 4, 4, 2, 1, 2};
    X[67] = new int[8]{3, 6, 3, 5, 5, 3, 2, 3};

    X[68] = new int[8]{5, 3, 3, 4, 3, 4, 5, 5};
    X[69] = new int[8]{6, 4, 4, 5, 4, 5, 6, 6};

    X[70] = new int[8]{3, 2, 3, 3, 3, 3, 3, 5};
    X[71] = new int[8]{4, 3, 4, 4, 4, 4, 4, 6};

    X[72] = new int[8]{3, 2, 2, 1, 1, 4, 1, 4};
    X[73] = new int[8]{4, 3, 3, 2, 2, 5, 2, 5};

    X[74] = new int[8]{5, 5, 3, 2, 2, 4, 2, 1};
    X[75] = new int[8]{6, 6, 4, 3, 3, 5, 3, 2};

    X[76] = new int[8]{3, 4, 4, 5, 5, 1, 2, 2};
    X[77] = new int[8]{4, 5, 5, 6, 6, 2, 3, 3};

    X[78] = new int[8]{4, 4, 5, 3, 2, 1, 1, 3};
    X[79] = new int[8]{5, 5, 6, 4, 3, 2, 2, 4};

    X[80] = new int[8]{3, 1, 1, 3, 2, 2, 3, 5};
    X[81] = new int[8]{4, 2, 2, 4, 3, 3, 4, 6};

    X[82] = new int[8]{5, 1, 1, 2, 2, 1, 1, 4};
    X[83] = new int[8]{6, 2, 2, 3, 3, 2, 2, 5};

    X[84] = new int[8]{4, 1, 2, 1, 4, 1, 4, 2};
    X[85] = new int[8]{5, 2, 3, 2, 5, 2, 5, 3};

    X[86] = new int[8]{3, 5, 3, 2, 2, 3, 3, 4};
    X[87] = new int[8]{4, 6, 4, 3, 3, 4, 4, 5};

    X[88] = new int[8]{3, 1, 3, 4, 2, 4, 2, 2};
    X[89] = new int[8]{4, 2, 4, 5, 3, 5, 3, 3};

    X[90] = new int[8]{4, 3, 5, 5, 4, 3, 5, 3};
    X[91] = new int[8]{5, 4, 6, 6, 5, 4, 6, 4};

    X[92] = new int[8]{2, 3, 5, 2, 2, 3, 1, 5};
    X[93] = new int[8]{3, 4, 6, 3, 3, 4, 2, 6};

    X[94] = new int[8]{3, 4, 2, 5, 2, 1, 2, 3};
    X[95] = new int[8]{4, 5, 3, 6, 3, 2, 3, 4};

    X[96] = new int[8]{5, 1, 3, 4, 5, 4, 2, 2};
    X[97] = new int[8]{6, 2, 4, 5, 6, 5, 3, 3};

    X[98] = new int[8]{2, 3, 1, 1, 2, 3, 3, 3};
    X[99] = new int[8]{3, 4, 2, 2, 3, 4, 4, 4};

    X[100] = new int[8]{3, 3, 5, 3, 4, 2, 1, 5};
    X[101] = new int[8]{4, 4, 6, 4, 5, 3, 2, 6};

    X[102] = new int[8]{5, 1, 3, 1, 1, 2, 4, 3};
    X[103] = new int[8]{6, 2, 4, 2, 2, 3, 5, 4};

    X[104] = new int[8]{2, 3, 5, 5, 3, 3, 3, 1};
    X[105] = new int[8]{3, 4, 6, 6, 4, 4, 4, 2};

    X[106] = new int[8]{4, 2, 2, 2, 3, 2, 5, 4};
    X[107] = new int[8]{5, 3, 3, 3, 4, 3, 6, 5};

    X[108] = new int[8]{2, 2, 2, 3, 4, 2, 2, 5};
    X[109] = new int[8]{3, 3, 3, 4, 5, 3, 3, 6};

    X[110] = new int[8]{5, 3, 4, 2, 1, 3, 2, 3};
    X[111] = new int[8]{6, 4, 5, 3, 2, 4, 3, 4};

    X[112] = new int[8]{2, 3, 3, 3, 2, 4, 2, 3};
    X[113] = new int[8]{3, 4, 4, 4, 3, 5, 3, 4};

    X[114] = new int[8]{3, 3, 3, 5, 4, 4, 5, 4};
    X[115] = new int[8]{4, 4, 4, 6, 5, 5, 6, 5};

    X[116] = new int[8]{4, 3, 3, 3, 2, 1, 1, 4};
    X[117] = new int[8]{5, 4, 4, 4, 3, 2, 2, 5};

    X[118] = new int[8]{3, 3, 2, 5, 1, 1, 4, 1};
    X[119] = new int[8]{4, 4, 3, 6, 2, 2, 5, 2};

    X[120] = new int[8]{3, 4, 3, 2, 2, 1, 3, 1};
    X[121] = new int[8]{4, 5, 4, 3, 3, 2, 4, 2};

    X[122] = new int[8]{3, 4, 1, 3, 5, 4, 3, 3};
    X[123] = new int[8]{4, 5, 2, 4, 6, 5, 4, 4};

    X[124] = new int[8]{4, 5, 2, 2, 2, 1, 4, 4};
    X[125] = new int[8]{5, 6, 3, 3, 3, 2, 5, 5};

    X[126] = new int[8]{4, 4, 4, 3, 2, 3, 3, 5};
    X[127] = new int[8]{5, 5, 5, 4, 3, 4, 4, 6};

    X[128] = new int[8]{2, 3, 2, 3, 5, 2, 4, 2};
    X[129] = new int[8]{3, 4, 3, 4, 6, 3, 5, 3};

    X[130] = new int[8]{5, 5, 2, 2, 5, 3, 5, 1};
    X[131] = new int[8]{6, 6, 3, 3, 6, 4, 6, 2};

    X[132] = new int[8]{5, 1, 4, 1, 3, 4, 2, 5};
    X[133] = new int[8]{6, 2, 5, 2, 4, 5, 3, 6};
    
    
    for (int i = 0; i < 67; i ++)
    {
        data_outputs[i] = 0.01;
    }
    delete[] X[0];
    X[0] = new int[8]{3, 5, 4, 5, 1, 5, 3, 1};
    X[1] = new int[8]{5, -1, -1, -1, 2, -1, 4, 3};

    X[2] = new int[8]{4, 3, 1, 2, 3, 4, 8, 4};
    X[3] = new int[8]{-1, 4, 2, 3, 4, -1, 1, -1};

    X[4] = new int[8]{3, 5, 2, 1, 8, 5, 4, 2};
    X[5] = new int[8]{5, -1, 4, 3, 2, -1, -1, 4};

    X[6] = new int[8]{2, 5, 8, 8, 4, 4, 4, 1};
    X[7] = new int[8]{4, -1, 2, 2, -1, -1, -1, 3};

    X[8] = new int[8]{2, 4, 1, 5, 2, 5, 5, 4};
    X[9] = new int[8]{4, -1, 2, -1, 4, -1, -1, -1};

    X[10] = new int[8]{2, 4, 5, 3, 8, 3, 1, 5};
    X[11] = new int[8]{4, -1, -1, 5, 1, 4, 2, -1};

    X[12] = new int[8]{5, 8, 2, 4, 2, 3, 1, 1};
    X[13] = new int[8]{-1, 1, 3, -1, 3, 4, 2, 3};

    X[14] = new int[8]{2, 3, 3, 1, 8, 1, 4, 5};
    X[15] = new int[8]{3, 4, 5, 3, 3, 2, -1, -1};

    X[16] = new int[8]{4, 5, 5, 5, 1, 3, 8, 3};
    X[17] = new int[8]{-1, -1, -1, -1, 2, 5, 2, 4};

    X[18] = new int[8]{8, 8, 8, 1, 8, 1, 4, 2};
    X[19] = new int[8]{2, 3, 3, 2, 3, 3, -1, 3};

    X[20] = new int[8]{5, 4, 2, 5, 4, 4, 5, 4};
    X[21] = new int[8]{-1, -1, 3, -1, -1, -1, -1, -1};

    X[22] = new int[8]{8, 5, 5, 5, 5, 8, 5, 5};
    X[23] = new int[8]{2, -1, -1, -1, -1, 2, -1, -1};

    X[24] = new int[8]{4, 1, 1, 8, 5, 8, 1, 5};
    X[25] = new int[8]{-1, 2, 3, 3, -1, 1, 3, -1};

    X[26] = new int[8]{8, 2, 1, 4, 8, 5, 8, 8};
    X[27] = new int[8]{3, 3, 3, -1, 1, -1, 2, 1};

    X[28] = new int[8]{5, 8, 8, 8, 5, 3, 2, 5};
    X[29] = new int[8]{-1, 2, 3, 2, -1, 4, 3, -1};

    X[30] = new int[8]{4, 2, 5, 2, 8, 4, 8, 8};
    X[31] = new int[8]{-1, 4, -1, 4, 3, -1, 2, 3};

    X[32] = new int[8]{3, 5, 5, 8, 3, 3, 2, 4};
    X[33] = new int[8]{5, -1, -1, 2, 5, 5, 4, -1};

    X[34] = new int[8]{8, 4, 2, 8, 2, 8, 3, 5};
    X[35] = new int[8]{2, -1, 3, 2, 4, 2, 4, -1};

    X[36] = new int[8]{5, 1, 5, 1, 1, 8, 8, 8};
    X[37] = new int[8]{-1, 2, -1, 3, 2, 2, 1, 2};

    X[38] = new int[8]{2, 2, 5, 1, 1, 1, 1, 4};
    X[39] = new int[8]{3, 3, -1, 3, 2, 3, 3, -1};

    X[40] = new int[8]{2, 3, 4, 8, 8, 2, 5, 4};
    X[41] = new int[8]{3, 4, -1, 2, 3, 4, -1, -1};

    X[42] = new int[8]{8, 2, 3, 5, 2, 4, 8, 1};
    X[43] = new int[8]{2, 3, 5, -1, 3, -1, 3, 3};

    X[44] = new int[8]{2, 4, 3, 5, 5, 5, 2, 5};
    X[45] = new int[8]{4, -1, 5, -1, -1, -1, 4, -1};

    X[46] = new int[8]{8, 3, 8, 5, 2, 4, 5, 8};
    X[47] = new int[8]{2, 5, 1, -1, 3, -1, -1, 1};

    X[48] = new int[8]{3, 5, 4, 4, 8, 8, 8, 4};
    X[49] = new int[8]{4, -1, -1, -1, 2, 2, 1, -1};

    X[50] = new int[8]{8, 4, 3, 8, 5, 8, 3, 3};
    X[51] = new int[8]{3, -1, 4, 2, -1, 3, 4, 4};

    X[52] = new int[8]{8, 8, 3, 8, 8, 4, 4, 1};
    X[53] = new int[8]{2, 1, 4, 2, 1, -1, -1, 3};

    X[54] = new int[8]{2, 3, 5, 3, 8, 2, 5, 5};
    X[55] = new int[8]{4, 4, -1, 5, 3, 3, -1, -1};

    X[56] = new int[8]{8, 1, 5, 1, 5, 2, 5, 1};
    X[57] = new int[8]{3, 2, -1, 3, -1, 3, -1, 2};

    X[58] = new int[8]{4, 8, 4, 2, 8, 5, 3, 1};
    X[59] = new int[8]{-1, 2, -1, 3, 1, -1, 5, 2};

    X[60] = new int[8]{5, 1, 8, 3, 8, 5, 3, 5};
    X[61] = new int[8]{-1, 2, 2, 4, 3, -1, 4, -1};

    X[62] = new int[8]{4, 8, 1, 3, 2, 2, 8, 5};
    X[63] = new int[8]{-1, 2, 2, 4, 4, 4, 3, -1};

    X[64] = new int[8]{8, 2, 1, 3, 5, 1, 8, 5};
    X[65] = new int[8]{2, 4, 2, 5, -1, 3, 1, -1};

    X[66] = new int[8]{3, 4, 3, 4, 2, 2, 8, 4};
    X[67] = new int[8]{5, -1, 5, -1, 3, 3, 3, -1};

    X[68] = new int[8]{3, 2, 5, 4, 2, 4, 4, 2};
    X[69] = new int[8]{4, 4, -1, -1, 3, -1, -1, 4};

    X[70] = new int[8]{8, 3, 5, 1, 1, 8, 8, 1};
    X[71] = new int[8]{2, 5, -1, 2, 2, 1, 2, 3};

    X[72] = new int[8]{2, 4, 8, 8, 3, 5, 2, 2};
    X[73] = new int[8]{4, -1, 2, 3, 5, -1, 4, 3};

    X[74] = new int[8]{2, 2, 2, 5, 2, 8, 4, 2};
    X[75] = new int[8]{3, 3, 3, -1, 4, 3, -1, 3};

    X[76] = new int[8]{3, 8, 5, 8, 2, 5, 5, 8};
    X[77] = new int[8]{5, 1, -1, 2, 4, -1, -1, 3};

    X[78] = new int[8]{2, 8, 8, 1, 4, 8, 2, 1};
    X[79] = new int[8]{3, 3, 1, 3, -1, 1, 3, 2};

    X[80] = new int[8]{8, 5, 8, 2, 2, 1, 3, 5};
    X[81] = new int[8]{2, -1, 1, 3, 3, 3, 4, -1};

    X[82] = new int[8]{8, 3, 2, 2, 5, 8, 4, 3};
    X[83] = new int[8]{2, 5, 3, 3, -1, 1, -1, 4};

    X[84] = new int[8]{3, 5, 8, 8, 2, 8, 2, 8};
    X[85] = new int[8]{5, -1, 2, 1, 4, 3, 4, 2};

    X[86] = new int[8]{4, 8, 8, 8, 1, 1, 1, 3};
    X[87] = new int[8]{-1, 1, 2, 1, 2, 3, 3, 4};

    X[88] = new int[8]{4, 1, 5, 8, 3, 5, 4, 2};
    X[89] = new int[8]{-1, 2, -1, 1, 5, -1, -1, 4};

    X[90] = new int[8]{5, 1, 8, 3, 5, 2, 4, 4};
    X[91] = new int[8]{-1, 3, 2, 5, -1, 3, -1, -1};

    X[92] = new int[8]{3, 3, 5, 3, 8, 1, 5, 8};
    X[93] = new int[8]{5, 5, -1, 4, 1, 2, -1, 1};

    X[94] = new int[8]{4, 4, 4, 3, 1, 8, 1, 4};
    X[95] = new int[8]{-1, -1, -1, 5, 2, 2, 3, -1};

    X[96] = new int[8]{4, 4, 3, 4, 3, 3, 4, 2};
    X[97] = new int[8]{-1, -1, 4, -1, 5, 4, -1, 3};

    X[98] = new int[8]{8, 1, 1, 3, 5, 5, 3, 3};
    X[99] = new int[8]{2, 2, 2, 5, -1, -1, 5, 5};

    X[100] = new int[8]{5, 4, 3, 8, 3, 4, 3, 8};
    X[101] = new int[8]{-1, -1, 5, 2, 5, -1, 5, 1};

    X[102] = new int[8]{8, 2, 8, 1, 5, 1, 8, 4};
    X[103] = new int[8]{3, 3, 1, 2, -1, 2, 2, -1};

    X[104] = new int[8]{8, 8, 2, 4, 5, 3, 3, 3};
    X[105] = new int[8]{2, 3, 3, -1, -1, 4, 5, 5};

    X[106] = new int[8]{5, 5, 3, 2, 4, 4, 2, 8};
    X[107] = new int[8]{-1, -1, 5, 4, -1, -1, 4, 1};

    X[108] = new int[8]{5, 3, 4, 1, 5, 1, 2, 1};
    X[109] = new int[8]{-1, 5, -1, 2, -1, 3, 4, 2};

    X[110] = new int[8]{5, 1, 1, 2, 3, 8, 1, 1};
    X[111] = new int[8]{-1, 3, 3, 3, 4, 1, 3, 3};

    X[112] = new int[8]{5, 8, 5, 4, 5, 5, 5, 5};
    X[113] = new int[8]{-1, 1, -1, -1, -1, -1, -1, -1};

    X[114] = new int[8]{8, 4, 2, 5, 1, 8, 4, 5};
    X[115] = new int[8]{2, -1, 3, -1, 3, 2, -1, -1};

    X[116] = new int[8]{2, 5, 3, 5, 5, 4, 8, 3};
    X[117] = new int[8]{4, -1, 4, -1, -1, -1, 2, 5};

    X[118] = new int[8]{4, 5, 3, 8, 3, 8, 2, 4};
    X[119] = new int[8]{-1, -1, 5, 3, 5, 2, 3, -1};

    X[120] = new int[8]{5, 4, 8, 5, 5, 3, 8, 1};
    X[121] = new int[8]{-1, -1, 1, -1, -1, 4, 3, 2};

    X[122] = new int[8]{8, 4, 3, 4, 8, 2, 8, 3};
    X[123] = new int[8]{3, -1, 5, -1, 1, 3, 3, 5};

    X[124] = new int[8]{8, 3, 3, 4, 5, 1, 8, 1};
    X[125] = new int[8]{3, 5, 5, -1, -1, 2, 1, 3};

    X[126] = new int[8]{4, 5, 5, 2, 3, 8, 1, 4};
    X[127] = new int[8]{-1, -1, -1, 3, 4, 3, 2, -1};

    X[128] = new int[8]{5, 3, 4, 5, 2, 8, 8, 1};
    X[129] = new int[8]{-1, 4, -1, -1, 3, 1, 3, 2};

    X[130] = new int[8]{2, 8, 4, 4, 4, 1, 5, 8};
    X[131] = new int[8]{3, 2, -1, -1, -1, 3, -1, 2};

    X[132] = new int[8]{3, 8, 5, 1, 3, 8, 5, 5};
    X[133] = new int[8]{4, 3, -1, 3, 5, 3, -1, -1};
    
    
    for (int i = 67; i < 134; i ++)
    {
        data_outputs[i] = 0.99;
    }

    

    
    int dimension = 23;
    int num_data_points = 67;
    
    Eigen::VectorXd theta = TheRegression::bestFitF(basis, X, data_outputs, dimension, num_data_points);
    
    float s = 0;
    int l_1[8];
    int l_2[8];

    for (int i = 0; i < 8; i++) 
    {
        l_1[i] = i;
        l_2[i] = i - 1;
    }
    l_1[0] = 8;
   
   
    std::cout << EvaluationFunction::Evaluate(basis, theta, l_1, l_2, dimension) << std::endl;
    std::cout << EvaluationFunction::TestAi(basis, theta, X, data_outputs, dimension, num_data_points);
    return 0;
}